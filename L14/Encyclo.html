<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
</head>

<body>
  <style>
    .forward {
      text-decoration: underline;
    }
  </style>
  <div id="mainP"></div>
  <script src='https://fe.it-academy.by/JQ/jquery.js'></script>
  <script>
    'use strict'
    window.onhashchange = switchToStateFromURLHash;
    let SPAState = {};
    let articles = {};
    let articlesNames = [ "Слон", "Жираф", "Бегемот", "Бурундук", "Собака", "Свинья", "ОБезьяна", "Жопа",];

    function LoadArticles() {
        $.ajax("https://sssstart.000webhostapp.com/L14/articles.html",
            { type:'GET', dataType:'html', success:dataLoaded, error:errorHandler }
        );
    }

    function dataLoaded(data) {
        console.log('загруженные через AJAX данные:');
        console.log(data);

    }

    function errorHandler(jqXHR,statusStr,errorStr) {
        alert(statusStr+' '+errorStr);
    }

    LoadArticles();


/*     let photos = {
      1: { image: "futu.png", comment: "собака Шарик" },
      2: { image: "homer.png", comment: "собака Барбос" },
      3: { image: "pokemon.png", comment: "собака Барбос" }
    }; */

    function click() {
      alert("click");
    }

    function switchToStateFromURLHash() {


      let URLHash = window.location.hash;
      
      let stateStr = decodeURIComponent(URLHash).substr(1);

      if (stateStr != "") { // если закладка непустая, читаем из неё состояние и отображаем
        let parts = stateStr.split("_")
        SPAState = { pagename: parts[0] }; // первая часть закладки - номер страницы
        if (SPAState.pagename == 'Photo')
          SPAState.photoid = parts[1]; // для фото нужна ещё вторая часть закладки - номер фото
      }
      else
        SPAState = { pagename: 'Main' };

      let pageHTML = "";


      switch (SPAState.pagename) {
        case 'Main':
          pageHTML += "<h1 align=center >Энциклопедия</h3>";
          pageHTML += "<p align=center id=list1 class=forward>Список статей здесь</p>";
          break;
        case 'List':
          pageHTML += "<h2 align=center>Оглавление</h2>";

          articlesNames.sort();

          let firstL;
          for (let index = 0; index < articlesNames.length; index++) {

            const element = articlesNames[index];

            let elementStr = element.toString();
            if (elementStr[0] != firstL) {
              firstL = elementStr[0];
              pageHTML += "<h2>" + firstL + "</h2>";
            }

            pageHTML += "<p class=forward id=" + element + ">" + element + "</p>";

          }


          /*  pageHTML += "<img src='" + photo.image + "'>";
           pageHTML += "<p><i>" + photo.comment + "</i></p>"; */
          break;
        /* case 'List':
            pageHTML += "<h2>Оглавление</h2>";
            pageHTML += "<p>Мы круты!</p>";
            break; */
            default: articleChose();
      }

      function articleChose () {
        if (articlesNames.includes(stateStr)) {
          alert(stateStr)
        } else {
          alert("нет")
        }
        };

      document.getElementById('mainP').innerHTML = pageHTML;

      let but1 = document.getElementById('list1');
      if (but1 != undefined) {
        but1.addEventListener('dblclick', switchToListPage)
      };

      if (SPAState.pagename==='List'&&articlesNames.length != 0) {
        for (let index = 0; index < articlesNames.length; index++) {
          const element = articlesNames[index];
          let elementStr = element.toString();
          let button = document.getElementById(element);
          button.addEventListener('dblclick', switchToMainPage)
        }
      }
    }

    function switchToState(newState) {
      location.hash = newState;
    }

    function switchToMainPage() {
      switchToState('Main');
    }

    function switchToListPage() {
      switchToState('List');
    }

  /*   function switchToArticlePage(named) {
      switchToState({ pagename: 'article', pageid: named });
    } */
    

    /* function switchToState(newState) {
      let stateStr = newState.pagename;
      if (newState.pagename == 'Photo')
        stateStr += "_" + newState.photoid;
      location.hash = stateStr;

    }

    function switchToMainPage() {
      switchToState({ pagename: 'Main' });
    }

    function switchToPhotoPage(photoId) {
      switchToState({ pagename: 'Photo', photoid: photoId });
    }

    function switchToListPage() {
      switchToState({ pagename: 'List' });
    } */

    switchToStateFromURLHash();

  </script>


  <!--   <br>
  <input type=button value='Главная' onclick='switchToMainPage()'>
  <span id='IPhotosButtons'></span>
  <script>
    var photosStr = "";
    for (var photoId in photos) {
      var photo = photos[photoId];
      photosStr += '<input type=button value="' + photo.comment + '" onclick="switchToPhotoPage(' + photoId + ')"> ';
    }
    document.getElementById('IPhotosButtons').innerHTML = photosStr;
  </script>
  <input type=button value='О нас' onclick='switchToListPage()'> -->


</body>